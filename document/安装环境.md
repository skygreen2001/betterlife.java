# Betterlife.Java消息服务器: 安装环境

## 安装基础服务器

- Rabbitmq
- Redis

## 运行RabbitMQ Server
- [Ubuntu: Start and Stop the RabbitMQ Server] (https://pubs.vmware.com/vfabric53/index.jsp?topic=/com.vmware.vfabric.rabbitmq.3.2/getstart/install-start-server-ubuntu.html)
- [RabbitMQ安装和使用](http://www.jianshu.com/p/2d4b81c8b403)
- 安装路径
    [Mac系统](/usr/local/Cellar/rabbitmq/)

- 下载:
```
> sudo apt-get install rabbitmq-server
```

- 启动:
```
> invoke-rc.d rabbitmq-server start
```

- 停止:
```
> invoke-rc.d rabbitmq-server stop
```

- 管理:
```
> rabbitmq-plugins enable rabbitmq_management
```

- 外网浏览器访问管理:
测试账户: itaskTour2006 
密码: skygreen2001
设置角色: 
```
> sudo rabbitmqctl add_user itaskTour2006 skygreen2001
> sudo rabbitmqctl set_user_tags itaskTour2006 administrator
> sudo rabbitmqctl set_permissions -p / itaskTour2006 '.*' '.*' '.*'
> sudo rabbitmqctl list_users
```

访问: 
- http://127.0.0.1:15672/
- http://debug.itasktour.com:15672/
- http://v3.itasktour.com:15672/
- http://192.168.2.12:15672/    
    
## 内存持久化
- Redis
    - [下载Redis](https://redis.io/download)
    - 生成运行包
    ```
    > cd redis-4.0.1 && make && make test [第一次]
    ```
    - [启动Redis]  
    ```
    > src/redis-server
    ```
    - [在服务器上部署Redis](https://redis.io/topics/quickstart)
      - [How To Install and Configure Redis on Ubuntu 16.04](https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-redis-on-ubuntu-16-04)
        ```
        > sudo cp src/redis-server /usr/local/bin/ && sudo cp src/redis-cli /usr/local/bin/
        > sudo mkdir /etc/redis && sudo mkdir /var/redis
        > sudo cp utils/redis_init_script /etc/init.d/redis_6379
        > sudo vi /etc/init.d/redis_6379
        > sudo cp redis.conf /etc/redis/6379.conf
        > sudo mkdir /var/redis/6379
        > sudo vi /etc/redis/6379.conf
          - daemonize yes
          - pidfile /var/run/redis_6379.pid
          - logfile "/var/log/redis_6379.log"
          - dir /var/redis/6379
        > sudo update-rc.d redis_6379 defaults
        > sudo /etc/init.d/redis_6379 start
        ```
    
## 参考
- [Ubuntu: Start and Stop the RabbitMQ Server](https://pubs.vmware.com/vfabric53/index.jsp?topic=/com.vmware.vfabric.rabbitmq.3.2/getstart/install-start-server-ubuntu.html)
- [物联网通信协议](https://github.com/ruizeng/blog/blob/master/IoT/iot-protocols.md)
- [RabbitMQ Quick（快速手册）](https://geewu.gitbooks.io/rabbitmq-quick/content/RabbitMQ%E4%BB%8B%E7%BB%8D.html)
- [Spring Data Redis](https://docs.spring.io/spring-data/redis/docs/current/reference/html/)
